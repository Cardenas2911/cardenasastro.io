---
import ChartRenderer from "./ChartRenderer.astro";
import { wrapLabel, palette, globalTooltipOptions } from "./chartUtils";

// Data placeholders - In a real reusable scenario, these could be props or fetched
// For now, we match the user's requesting mock data structure.

const trafficData = {
    labels: ["2023", "2024", "2025", "2026", "2027"],
    datasets: [
        {
            label: "B√∫squeda Basada en Enlaces (Google)",
            data: [92, 78, 55, 38, 20],
            backgroundColor: palette.neutral,
            borderRadius: 6,
        },
        {
            label: "B√∫squeda Generativa (GEO)",
            data: [8, 22, 45, 62, 80],
            backgroundColor: palette.gold,
            borderRadius: 6,
        },
    ],
};

trafficData.datasets.forEach((ds) => {
    ds.label = wrapLabel(ds.label);
});

const radarLabels = [
    "Volumen de Keywords",
    "Autoridad de Entidad",
    "Estructura JSON-LD",
    "Co-citaci√≥n Externa",
    "Velocidad de Carga",
    "Contenido Sint√©tico",
];

const doughnutLabels = [
    "Autoridad de Marca",
    "Relevancia Sem√°ntica",
    "Datos Estructurados",
    "Citas/Backlinks",
    "Frescura",
];

const doughnutData = {
    labels: doughnutLabels,
    datasets: [
        {
            data: [30, 25, 20, 15, 10],
            backgroundColor: [
                palette.gold, // Autoridad
                palette.goldLight, // Relevancia
                palette.white, // Datos
                palette.neutral, // Citas
                "#262626", // Frescura
            ],
            borderWidth: 0,
            hoverOffset: 10,
        },
    ],
};

const radarData = {
    labels: radarLabels.map((l) => wrapLabel(l)),
    datasets: [
        {
            label: "SEO Cl√°sico",
            data: [95, 45, 30, 40, 75, 20],
            borderColor: palette.neutral,
            backgroundColor: "rgba(115, 115, 115, 0.15)",
            borderWidth: 2,
            pointRadius: 3,
        },
        {
            label: "GEO Strategy",
            data: [35, 95, 100, 90, 98, 90],
            borderColor: palette.gold,
            backgroundColor: "rgba(212, 175, 55, 0.2)",
            borderWidth: 3,
            pointRadius: 4,
        },
    ],
};

const trafficOptions = {
    scales: {
        x: {
            stacked: true,
            grid: { display: false },
            ticks: { color: palette.neutral },
        },
        y: {
            stacked: true,
            display: false,
        },
    },
    plugins: {
        legend: {
            position: "bottom",
            labels: {
                boxWidth: 12,
                font: { size: 10 },
                color: palette.white,
            },
        },
        tooltip: globalTooltipOptions,
    },
};

const doughnutOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
        legend: {
            position: "right",
            labels: {
                boxWidth: 15,
                font: { size: 11 },
                color: palette.white,
            },
        },
        tooltip: globalTooltipOptions,
    },
};

const radarOptions = {
    scales: {
        r: {
            angleLines: { color: "rgba(255,255,255,0.1)" },
            grid: { color: "rgba(255,255,255,0.1)" },
            ticks: { display: false },
            pointLabels: {
                font: { size: 10, weight: "bold" },
                color: palette.white,
            },
        },
    },
    plugins: {
        legend: {
            position: "top",
            labels: {
                boxWidth: 12,
                font: { weight: "bold" },
                color: palette.white,
            },
        },
        tooltip: globalTooltipOptions,
    },
};
---

<div
    class="geo-infographic-wrapper bg-neutral-950 text-white font-sans antialiased selection:bg-gold/20"
>
    {/* HERO: T√≠tulo y Estad√≠sticas R√°pidas */}
    <header
        class="relative bg-black text-white pt-24 pb-36 rounded-b-[3rem] overflow-hidden shadow-2xl border-b border-neutral-800"
    >
        <div
            class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gold/10 via-black to-black z-0"
        >
        </div>
        <div class="max-w-7xl mx-auto px-6 relative z-10 text-center">
            <div
                class="inline-block px-4 py-1 mb-8 rounded-full border border-gold/30 bg-gold/5 backdrop-blur-md"
            >
                <span
                    class="text-gold font-bold tracking-widest text-xs uppercase"
                    >Evoluci√≥n Digital 2025</span
                >
            </div>
            <h1
                class="text-5xl md:text-7xl font-black mb-8 leading-tight tracking-tighter"
            >
                GEO: La Gu√≠a <br />
                <span
                    class="text-transparent bg-clip-text bg-gradient-to-r from-gold via-yellow-200 to-gold"
                    >Definitiva para Marcas</span
                >
            </h1>
            <p
                class="text-xl text-neutral-400 max-w-3xl mx-auto mb-16 font-light leading-relaxed"
            >
                Domina las respuestas de <strong class="text-white"
                    >ChatGPT, Perplexity y Gemini</strong
                > de la mano de Nicol√°s C√°rdenas.
            </p>

            <div
                class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-5xl mx-auto"
            >
                <div
                    class="p-6 bg-neutral-900/50 rounded-3xl border border-neutral-800 hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-white group-hover:text-gold transition-colors"
                    >
                        10+
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        A√±os Exp.
                    </div>
                </div>
                <div
                    class="p-6 bg-neutral-900/50 rounded-3xl border border-neutral-800 hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-white group-hover:text-gold transition-colors"
                    >
                        SEO
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        First Focus
                    </div>
                </div>
                <div
                    class="p-6 bg-neutral-900/50 rounded-3xl border border-neutral-800 hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-white group-hover:text-gold transition-colors"
                    >
                        JSON
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        Linked Data
                    </div>
                </div>
                <div
                    class="p-6 bg-neutral-900/50 rounded-3xl border border-neutral-800 hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-white group-hover:text-gold transition-colors"
                    >
                        GEO
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        Expertise
                    </div>
                </div>
            </div>
        </div>
    </header>

    {/* SECCI√ìN 1: El Cambio de Paradigma */}
    <section class="py-24 max-w-7xl mx-auto px-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
            <div class="order-2 lg:order-1">
                <div
                    class="bg-neutral-900 p-8 rounded-[2.5rem] shadow-2xl border border-neutral-800"
                >
                    <h3
                        class="text-center font-bold text-neutral-400 mb-8 uppercase tracking-widest text-sm"
                    >
                        Cambio en el Tr√°fico de B√∫squeda
                    </h3>
                    <ChartRenderer
                        type="bar"
                        data={trafficData}
                        options={trafficOptions}
                        chartId="trafficEvolutionChart"
                        height="320px"
                    />
                </div>
            </div>
            <div class="order-1 lg:order-2">
                <h2 class="text-4xl font-black text-white mb-8 leading-tight">
                    De los Enlaces Azules a las <span class="text-gold"
                        >Respuestas Directas</span
                    >
                </h2>
                <p class="text-lg text-neutral-400 mb-8 leading-relaxed">
                    Ya no optimizamos para un buscador de listas, sino para
                    motores de respuesta. GEO es el proceso de estructurar la
                    informaci√≥n para que los LLMs la procesen y citen como
                    fuente de verdad.
                </p>
                <div
                    class="flex items-center gap-4 p-5 bg-gold/5 border-l-4 border-gold rounded-r-2xl"
                >
                    <span class="text-3xl">üí°</span>
                    <p class="text-sm text-gold font-medium">
                        En Astro, la velocidad de carga es cr√≠tica. Un sitio
                        lento es un sitio invisible para los bots de IA.
                    </p>
                </div>
            </div>
        </div>
    </section>

    {/* SECCI√ìN 2: El Algoritmo (Doughnut) */}
    <section class="py-24 bg-neutral-900 relative">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16">
                <span
                    class="text-gold font-bold tracking-widest text-sm uppercase"
                    >El Cerebro de la IA</span
                >
                <h2 class="text-3xl md:text-4xl font-bold text-white mt-2">
                    ¬øPor qu√© citan las IAs?
                </h2>
                <p class="text-neutral-400 max-w-2xl mx-auto mt-4">
                    A diferencia de Google, que prioriza backlinks, los LLMs
                    priorizan autoridad sem√°ntica y estructura de datos.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <!-- Doughnut Chart -->
                <div
                    class="bg-black p-8 rounded-2xl shadow-lg border border-neutral-800"
                >
                    <h3
                        class="text-lg font-bold text-neutral-200 mb-4 text-center"
                    >
                        Factores de Citaci√≥n en GEO
                    </h3>
                    <ChartRenderer
                        type="doughnut"
                        data={doughnutData}
                        options={doughnutOptions}
                        chartId="citationFactorsChart"
                        height="300px"
                    />
                    <div class="mt-6 text-center text-xs text-neutral-500">
                        *Estimaci√≥n basada en an√°lisis de Perplexity y
                        SearchGPT.
                    </div>
                </div>

                <!-- Explanation Cards -->
                <div class="space-y-6">
                    <div class="flex items-start group">
                        <div
                            class="flex-shrink-0 w-12 h-12 rounded-full bg-gold/10 flex items-center justify-center text-gold text-xl font-bold border border-gold/20 group-hover:bg-gold group-hover:text-black transition-colors"
                        >
                            1
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-bold text-white">
                                Autoridad de Entidad
                            </h4>
                            <p class="text-neutral-400 text-sm">
                                La IA debe reconocer tu marca como una entidad
                                experta. Consistencia en toda la web.
                            </p>
                        </div>
                    </div>
                    <div class="flex items-start group">
                        <div
                            class="flex-shrink-0 w-12 h-12 rounded-full bg-gold/10 flex items-center justify-center text-gold text-xl font-bold border border-gold/20 group-hover:bg-gold group-hover:text-black transition-colors"
                        >
                            2
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-bold text-white">
                                Datos Estructurados
                            </h4>
                            <p class="text-neutral-400 text-sm">
                                El c√≥digo que traduce tu contenido. Sin JSON-LD,
                                la IA adivina. Con Schema, sabe.
                            </p>
                        </div>
                    </div>
                    <div class="flex items-start group">
                        <div
                            class="flex-shrink-0 w-12 h-12 rounded-full bg-gold/10 flex items-center justify-center text-gold text-xl font-bold border border-gold/20 group-hover:bg-gold group-hover:text-black transition-colors"
                        >
                            3
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-bold text-white">
                                Claridad Sem√°ntica
                            </h4>
                            <p class="text-neutral-400 text-sm">
                                Textos concisos, listas y tablas. Las IAs
                                prefieren contenido f√°cil de procesar.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    {/* SECCI√ìN 3: Factores de Ranking (Radar) */}
    <section class="py-24 bg-neutral-900">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-black text-white">
                    Estrategia SEO vs GEO
                </h2>
                <p class="text-neutral-500 mt-4">
                    ¬øEn qu√© se fijan las IAs a diferencia de Google?
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div
                    class="bg-black p-8 rounded-[2.5rem] shadow-xl border border-neutral-800"
                >
                    <ChartRenderer
                        type="radar"
                        data={radarData}
                        options={radarOptions}
                        chartId="factorsRadarChart"
                        height="400px"
                    />
                </div>
                <div class="grid grid-cols-1 gap-6">
                    <div
                        class="p-8 bg-black rounded-3xl shadow-sm border border-neutral-800 hover:border-gold/30 transition-colors"
                    >
                        <h4
                            class="font-bold text-white mb-3 text-lg flex items-center"
                        >
                            <span class="mr-3 text-gold">üìç</span> Autoridad de Entidad
                        </h4>
                        <p class="text-sm text-neutral-400 leading-relaxed">
                            Las IAs no rankean p√°ginas, rankean entidades.
                            Posicionamos tu marca como una autoridad reconocida
                            sem√°nticamente.
                        </p>
                    </div>
                    <div
                        class="p-8 bg-black rounded-3xl shadow-sm border border-neutral-800 hover:border-gold/30 transition-colors"
                    >
                        <h4
                            class="font-bold text-white mb-3 text-lg flex items-center"
                        >
                            <span class="mr-3 text-gold">üß©</span> Estructura de Datos
                        </h4>
                        <p class="text-sm text-neutral-400 leading-relaxed">
                            Sin Schema markup (JSON-LD), la IA debe "alucinar"
                            tus datos. La implementaci√≥n t√©cnica es el puente.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    {/* SECCI√ìN 3: Proceso (Flow) */}
    <section class="py-24 bg-neutral-950">
        <div class="max-w-7xl mx-auto px-6">
            <h2 class="text-4xl font-black text-center text-white mb-20">
                Ruta Cr√≠tica hacia la Citaci√≥n
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                {/* Paso 1 */}
                <div
                    class="relative p-10 bg-neutral-900 rounded-3xl border border-neutral-800 text-center group hover:border-gold/30 transition-all"
                >
                    <div
                        class="text-5xl font-black text-neutral-800 mb-6 group-hover:text-gold/20 transition-colors"
                    >
                        01
                    </div>
                    <h4
                        class="font-bold text-white mb-3 text-lg underline decoration-gold decoration-4 underline-offset-8"
                    >
                        Audit
                    </h4>
                    <p class="text-xs text-neutral-500 leading-loose">
                        An√°lisis de presencia en Perplexity y SearchGPT.
                    </p>
                    <div
                        class="hidden md:block absolute -right-3 top-1/2 -translate-y-1/2 text-neutral-800 font-black text-2xl"
                    >
                        ‚ùØ
                    </div>
                </div>
                {/* Paso 2 */}
                <div
                    class="relative p-10 bg-neutral-900 rounded-3xl border border-neutral-800 text-center group hover:border-gold/30 transition-all"
                >
                    <div
                        class="text-5xl font-black text-neutral-800 mb-6 group-hover:text-gold/20 transition-colors"
                    >
                        02
                    </div>
                    <h4
                        class="font-bold text-white mb-3 text-lg underline decoration-gold decoration-4 underline-offset-8"
                    >
                        Schema
                    </h4>
                    <p class="text-xs text-neutral-500 leading-loose">
                        Inyecci√≥n masiva de metadatos estructurados.
                    </p>
                    <div
                        class="hidden md:block absolute -right-3 top-1/2 -translate-y-1/2 text-neutral-800 font-black text-2xl"
                    >
                        ‚ùØ
                    </div>
                </div>
                {/* Paso 3 */}
                <div
                    class="relative p-10 bg-neutral-900 rounded-3xl border border-neutral-800 text-center group hover:border-gold/30 transition-all"
                >
                    <div
                        class="text-5xl font-black text-neutral-800 mb-6 group-hover:text-gold/20 transition-colors"
                    >
                        03
                    </div>
                    <h4
                        class="font-bold text-white mb-3 text-lg underline decoration-gold decoration-4 underline-offset-8"
                    >
                        Content
                    </h4>
                    <p class="text-xs text-neutral-500 leading-loose">
                        Tablas y respuestas sintetizadas para IA.
                    </p>
                    <div
                        class="hidden md:block absolute -right-3 top-1/2 -translate-y-1/2 text-neutral-800 font-black text-2xl"
                    >
                        ‚ùØ
                    </div>
                </div>
                {/* Paso 4 */}
                <div
                    class="p-10 bg-gradient-to-br from-gold to-yellow-600 rounded-3xl text-white shadow-2xl shadow-gold/10 text-center"
                >
                    <div class="text-5xl font-black text-black/10 mb-6">04</div>
                    <h4
                        class="font-bold text-white mb-3 text-lg underline decoration-white/30 decoration-4 underline-offset-8"
                    >
                        Cite
                    </h4>
                    <p class="text-xs text-white/90 leading-loose">
                        Validaci√≥n de citaci√≥n y autoridad.
                    </p>
                </div>
            </div>
        </div>
    </section>

    {/* FOOTER: Perfil Experto */}
    <footer
        class="bg-black py-20 text-center text-neutral-500 border-t border-neutral-900"
    >
        <div class="max-w-4xl mx-auto px-6">
            <div class="mb-10 inline-flex items-center gap-2">
                <span class="w-12 h-1 px-1 bg-neutral-800 rounded-full"></span>
                <h3 class="text-white font-bold text-2xl tracking-tight">
                    Nicol√°s C√°rdenas
                </h3>
                <span class="w-12 h-1 px-1 bg-gold rounded-full"></span>
            </div>
            <p class="mb-12 text-neutral-400 text-lg font-light italic">
                "No construyo p√°ginas web, construyo activos digitales
                estrat√©gicos para la era de la IA."
            </p>
            <div class="flex flex-wrap justify-center gap-8 text-sm">
                <a
                    href="mailto:hola@cardenasnicolas.com"
                    class="text-gold font-bold hover:text-white transition-colors"
                    >hola@cardenasnicolas.com</a
                >
                <span class="hidden sm:inline text-neutral-800">|</span>
                <span class="text-neutral-500">üìç Medell√≠n, Colombia</span>
                <span class="hidden sm:inline text-neutral-800">|</span>
                <span class="text-neutral-600">@cardenasnicolas</span>
            </div>
        </div>
    </footer>
</div>
