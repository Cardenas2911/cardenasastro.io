---
import ChartRenderer from "./ChartRenderer.astro";
import { wrapLabel, palette, globalTooltipOptions } from "./chartUtils";

// Data placeholders - In a real reusable scenario, these could be props or fetched
// For now, we match the user's requesting mock data structure.

const trafficData = {
    labels: ["2023", "2024", "2025", "2026", "2027"],
    datasets: [
        {
            label: "B√∫squeda Generativa (GEO)",
            data: [8, 22, 45, 62, 80],
            backgroundColor: palette.gold,
            borderRadius: 6,
        },
        {
            label: "B√∫squeda Basada en Enlaces (Google)",
            data: [92, 78, 55, 38, 20],
            backgroundColor: palette.neutral,
            borderRadius: 6,
        },
    ],
};

trafficData.datasets.forEach((ds) => {
    ds.label = wrapLabel(ds.label);
});

const radarLabels = [
    "Volumen de Keywords",
    "Autoridad de Entidad",
    "Estructura JSON-LD",
    "Co-citaci√≥n Externa",
    "Velocidad de Carga",
    "Contenido Sint√©tico",
];

const doughnutLabels = [
    "Autoridad de Marca",
    "Relevancia Sem√°ntica",
    "Datos Estructurados",
    "Citas/Backlinks",
    "Frescura",
];

const doughnutData = {
    labels: doughnutLabels,
    datasets: [
        {
            data: [30, 25, 20, 15, 10],
            backgroundColor: [
                palette.gold, // Autoridad
                palette.goldLight, // Relevancia
                "#404040", // Datos (Dark Grey for visibility on white)
                palette.neutral, // Citas
                "#d4d4d4", // Frescura (Light Grey)
            ],
            borderWidth: 0,
            hoverOffset: 10,
        },
    ],
};

const radarData = {
    labels: radarLabels.map((l) => wrapLabel(l)),
    datasets: [
        {
            label: "SEO Cl√°sico",
            data: [95, 45, 30, 40, 75, 20],
            borderColor: palette.neutral,
            backgroundColor: "rgba(115, 115, 115, 0.1)",
            borderWidth: 2,
            pointRadius: 3,
        },
        {
            label: "GEO Strategy",
            data: [35, 95, 100, 90, 98, 90],
            borderColor: palette.gold,
            backgroundColor: "rgba(212, 175, 55, 0.2)",
            borderWidth: 3,
            pointRadius: 4,
        },
    ],
};

const trafficOptions = {
    scales: {
        x: {
            stacked: true,
            grid: { display: false },
            ticks: { color: palette.neutral },
        },
        y: {
            stacked: true,
            display: false,
        },
    },
    plugins: {
        legend: {
            position: "bottom",
            labels: {
                boxWidth: 12,
                font: { size: 10 },
                color: palette.dark,
            },
        },
        tooltip: globalTooltipOptions,
    },
};

const doughnutOptions = {
    responsive: true,
    maintainAspectRatio: false,
    plugins: {
        legend: {
            position: "right",
            labels: {
                boxWidth: 15,
                font: { size: 11 },
                color: palette.dark,
            },
        },
        tooltip: globalTooltipOptions,
    },
};

const radarOptions = {
    scales: {
        r: {
            angleLines: { color: "rgba(0,0,0,0.1)" },
            grid: { color: "rgba(0,0,0,0.1)" },
            ticks: { display: false },
            pointLabels: {
                font: { size: 10, weight: "bold" },
                color: palette.dark,
            },
        },
    },
    plugins: {
        legend: {
            position: "top",
            labels: {
                boxWidth: 12,
                font: { weight: "bold" },
                color: palette.dark,
            },
        },
        tooltip: globalTooltipOptions,
    },
};
---

<div
    class="geo-infographic-wrapper not-prose bg-white text-black font-sans antialiased selection:bg-gold/20"
>
    {/* HERO: T√≠tulo y Estad√≠sticas R√°pidas */}
    <header
        class="relative bg-neutral-50 pt-24 pb-36 rounded-b-[3rem] overflow-hidden shadow-xl border-b border-neutral-200"
    >
        <div
            class="absolute inset-0 bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gold/20 via-white to-white z-0"
        >
        </div>
        <div class="max-w-7xl mx-auto px-6 relative z-10 text-center">
            <div
                class="inline-block px-4 py-1 mb-8 rounded-full border border-gold/30 bg-gold/10 backdrop-blur-md"
            >
                <span
                    class="text-black font-bold tracking-widest text-xs uppercase"
                    >Evoluci√≥n Digital 2025</span
                >
            </div>
            <h1
                class="text-5xl md:text-7xl font-black mb-8 leading-tight tracking-tighter text-black"
            >
                GEO: La Gu√≠a <br />
                <span
                    class="text-transparent bg-clip-text bg-gradient-to-r from-gold via-yellow-500 to-gold"
                    >Definitiva para Marcas</span
                >
            </h1>
            <p
                class="text-xl text-neutral-800 max-w-3xl mx-auto mb-16 font-light leading-relaxed"
            >
                Domina las respuestas de <strong class="text-black"
                    >ChatGPT, Perplexity y Gemini</strong
                > de la mano de Nicol√°s C√°rdenas.
            </p>

            <div
                class="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-5xl mx-auto"
            >
                <div
                    class="p-6 bg-white rounded-3xl border border-neutral-200 shadow-sm hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-neutral-900 group-hover:text-gold transition-colors"
                    >
                        10+
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        A√±os Exp.
                    </div>
                </div>
                <div
                    class="p-6 bg-white rounded-3xl border border-neutral-200 shadow-sm hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-neutral-900 group-hover:text-gold transition-colors"
                    >
                        SEO
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        First Focus
                    </div>
                </div>
                <div
                    class="p-6 bg-white rounded-3xl border border-neutral-200 shadow-sm hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-neutral-900 group-hover:text-gold transition-colors"
                    >
                        JSON
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        Linked Data
                    </div>
                </div>
                <div
                    class="p-6 bg-white rounded-3xl border border-neutral-200 shadow-sm hover:border-gold/50 transition-colors group"
                >
                    <div
                        class="text-3xl font-bold text-neutral-900 group-hover:text-gold transition-colors"
                    >
                        GEO
                    </div>
                    <div
                        class="text-[10px] text-neutral-500 uppercase font-bold mt-1"
                    >
                        Expertise
                    </div>
                </div>
            </div>
        </div>
    </header>

    {/* SECCI√ìN 1: El Cambio de Paradigma */}
    <section class="py-24 max-w-7xl mx-auto px-6">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-20 items-center">
            <div class="order-2 lg:order-1">
                <div
                    class="bg-white p-8 rounded-[2.5rem] shadow-2xl border border-neutral-100"
                >
                    <h3
                        class="text-center font-bold text-neutral-500 mb-8 uppercase tracking-widest text-sm"
                    >
                        Cambio en el Tr√°fico de B√∫squeda
                    </h3>
                    <ChartRenderer
                        type="bar"
                        data={trafficData}
                        options={trafficOptions}
                        chartId="trafficEvolutionChart"
                        height="320px"
                    />
                </div>
            </div>
            <div class="order-1 lg:order-2">
                <h2
                    class="text-4xl font-black text-neutral-900 mb-8 leading-tight"
                >
                    La Evoluci√≥n <span class="text-gold">de la B√∫squeda</span>
                </h2>
                <p class="text-lg text-neutral-600 mb-8 leading-relaxed">
                    Ya no optimizamos para un buscador de listas, sino para
                    motores de respuesta. GEO es el proceso de estructurar la
                    informaci√≥n para que los LLMs la procesen y citen como
                    fuente de verdad.
                </p>
                <div
                    class="flex items-center gap-4 p-5 bg-gold/5 border-l-4 border-gold rounded-r-2xl"
                >
                    <span class="text-3xl">üí°</span>
                    <p class="text-sm text-neutral-700 font-medium">
                        En Astro, la velocidad de carga es cr√≠tica. Un sitio
                        lento es un sitio invisible para los bots de IA.
                    </p>
                </div>
            </div>
        </div>
    </section>

    {/* SECCI√ìN 2: El Algoritmo (Doughnut) */}
    <section class="py-24 bg-neutral-50 relative">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16">
                <span
                    class="text-gold font-bold tracking-widest text-sm uppercase"
                    >El Cerebro de la IA</span
                >
                <h2
                    class="text-3xl md:text-4xl font-bold text-neutral-900 mt-2"
                >
                    ¬øPor qu√© citan las IAs?
                </h2>
                <p class="text-neutral-600 max-w-2xl mx-auto mt-4">
                    A diferencia de Google, que prioriza backlinks, los LLMs
                    priorizan autoridad sem√°ntica y estructura de datos.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
                <!-- Doughnut Chart -->
                <div
                    class="bg-white p-8 rounded-2xl shadow-xl border border-neutral-200"
                >
                    <h3
                        class="text-lg font-bold text-neutral-800 mb-4 text-center"
                    >
                        Factores de Citaci√≥n en GEO
                    </h3>
                    <ChartRenderer
                        type="doughnut"
                        data={doughnutData}
                        options={doughnutOptions}
                        chartId="citationFactorsChart"
                        height="300px"
                    />
                    <div class="mt-6 text-center text-xs text-neutral-400">
                        *Estimaci√≥n basada en an√°lisis de Perplexity y
                        SearchGPT.
                    </div>
                </div>

                <!-- Explanation Cards -->
                <div class="space-y-6">
                    <div class="flex items-start group">
                        <div
                            class="flex-shrink-0 w-12 h-12 rounded-full bg-gold/10 flex items-center justify-center text-gold text-xl font-bold border border-gold/20 group-hover:bg-gold group-hover:text-black transition-colors"
                        >
                            1
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-bold text-neutral-900">
                                Autoridad de Entidad
                            </h4>
                            <p class="text-neutral-600 text-sm">
                                La IA debe reconocer tu marca como una entidad
                                experta. Consistencia en toda la web.
                            </p>
                        </div>
                    </div>
                    <div class="flex items-start group">
                        <div
                            class="flex-shrink-0 w-12 h-12 rounded-full bg-gold/10 flex items-center justify-center text-gold text-xl font-bold border border-gold/20 group-hover:bg-gold group-hover:text-black transition-colors"
                        >
                            2
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-bold text-neutral-900">
                                Datos Estructurados
                            </h4>
                            <p class="text-neutral-600 text-sm">
                                El c√≥digo que traduce tu contenido. Sin JSON-LD,
                                la IA adivina. Con Schema, sabe.
                            </p>
                        </div>
                    </div>
                    <div class="flex items-start group">
                        <div
                            class="flex-shrink-0 w-12 h-12 rounded-full bg-gold/10 flex items-center justify-center text-gold text-xl font-bold border border-gold/20 group-hover:bg-gold group-hover:text-black transition-colors"
                        >
                            3
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-bold text-neutral-900">
                                Claridad Sem√°ntica
                            </h4>
                            <p class="text-neutral-600 text-sm">
                                Textos concisos, listas y tablas. Las IAs
                                prefieren contenido f√°cil de procesar.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    {/* SECCI√ìN 3: Factores de Ranking (Radar) */}
    <section class="py-24 bg-white">
        <div class="max-w-7xl mx-auto px-6">
            <div class="text-center mb-16">
                <h2 class="text-4xl font-black text-neutral-900">
                    Estrategia SEO vs GEO
                </h2>
                <p class="text-neutral-500 mt-4">
                    ¬øEn qu√© se fijan las IAs a diferencia de Google?
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div
                    class="bg-neutral-50 p-8 rounded-[2.5rem] shadow-lg border border-neutral-200"
                >
                    <ChartRenderer
                        type="radar"
                        data={radarData}
                        options={radarOptions}
                        chartId="factorsRadarChart"
                        height="400px"
                    />
                </div>
                <div class="grid grid-cols-1 gap-6">
                    <div
                        class="p-8 bg-white rounded-3xl shadow-sm border border-neutral-200 hover:border-gold/30 transition-colors"
                    >
                        <h4
                            class="font-bold text-neutral-900 mb-3 text-lg flex items-center"
                        >
                            <span class="mr-3 text-gold">üìç</span> Autoridad de Entidad
                        </h4>
                        <p class="text-sm text-neutral-600 leading-relaxed">
                            Las IAs no rankean p√°ginas, rankean entidades.
                            Posicionamos tu marca como una autoridad reconocida
                            sem√°nticamente.
                        </p>
                    </div>
                    <div
                        class="p-8 bg-white rounded-3xl shadow-sm border border-neutral-200 hover:border-gold/30 transition-colors"
                    >
                        <h4
                            class="font-bold text-neutral-900 mb-3 text-lg flex items-center"
                        >
                            <span class="mr-3 text-gold">üß©</span> Estructura de Datos
                        </h4>
                        <p class="text-sm text-neutral-600 leading-relaxed">
                            Sin Schema markup (JSON-LD), la IA debe "alucinar"
                            tus datos. La implementaci√≥n t√©cnica es el puente.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    {/* SECCI√ìN 3: Proceso (Flow) */}
    <section class="py-24 bg-neutral-50">
        <div class="max-w-7xl mx-auto px-6">
            <h2 class="text-4xl font-black text-center text-neutral-900 mb-6">
                Ruta Cr√≠tica hacia la Citaci√≥n
            </h2>
            <p class="text-neutral-500 text-center max-w-2xl mx-auto mb-16">
                ¬øC√≥mo optimizar tu sitio hoy para el ma√±ana?
            </p>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                {/* Paso 1 */}
                <div
                    class="relative p-10 bg-white rounded-3xl border border-neutral-200 text-center group hover:border-gold/30 transition-all shadow-sm"
                >
                    <div
                        class="text-5xl font-black text-neutral-100 mb-6 group-hover:text-gold/20 transition-colors"
                    >
                        01
                    </div>
                    <h4
                        class="font-bold text-neutral-900 mb-3 text-lg underline decoration-gold decoration-4 underline-offset-8"
                    >
                        Auditor√≠a SEO
                    </h4>
                    <p class="text-xs text-neutral-500 leading-loose">
                        Evaluamos si las IAs ya reconocen tu marca. Preguntamos
                        a ChatGPT y Perplexity para analizar vac√≠os o errores.
                    </p>
                    <div
                        class="hidden md:block absolute -right-3 top-1/2 -translate-y-1/2 text-neutral-300 font-black text-2xl"
                    >
                        ‚ùØ
                    </div>
                </div>
                {/* Paso 2 */}
                <div
                    class="relative p-10 bg-white rounded-3xl border border-neutral-200 text-center group hover:border-gold/30 transition-all shadow-sm"
                >
                    <div
                        class="text-5xl font-black text-neutral-100 mb-6 group-hover:text-gold/20 transition-colors"
                    >
                        02
                    </div>
                    <h4
                        class="font-bold text-neutral-900 mb-3 text-lg underline decoration-gold decoration-4 underline-offset-8"
                    >
                        Estructura
                    </h4>
                    <p class="text-xs text-neutral-500 leading-loose">
                        Inyecci√≥n masiva de Schema. Definimos "Organizaci√≥n",
                        "Servicios" y "FAQ" para alimentar al modelo con hechos.
                    </p>
                    <div
                        class="hidden md:block absolute -right-3 top-1/2 -translate-y-1/2 text-neutral-300 font-black text-2xl"
                    >
                        ‚ùØ
                    </div>
                </div>
                {/* Paso 3 */}
                <div
                    class="relative p-10 bg-white rounded-3xl border border-neutral-200 text-center group hover:border-gold/30 transition-all shadow-sm"
                >
                    <div
                        class="text-5xl font-black text-neutral-100 mb-6 group-hover:text-gold/20 transition-colors"
                    >
                        03
                    </div>
                    <h4
                        class="font-bold text-neutral-900 mb-3 text-lg underline decoration-gold decoration-4 underline-offset-8"
                    >
                        Contenido
                    </h4>
                    <p class="text-xs text-neutral-500 leading-loose">
                        Creaci√≥n de contenido sint√©tico para IA: Tablas, listas
                        claras y respuestas directas (M√©todo BLUF: la conclusi√≥n
                        primero).
                    </p>
                    <div
                        class="hidden md:block absolute -right-3 top-1/2 -translate-y-1/2 text-neutral-300 font-black text-2xl"
                    >
                        ‚ùØ
                    </div>
                </div>
                {/* Paso 4 */}
                <div
                    class="p-10 bg-gradient-to-br from-gold to-yellow-600 rounded-3xl text-white shadow-xl shadow-gold/20 text-center"
                >
                    <div class="text-5xl font-black text-white/20 mb-6">04</div>
                    <h4
                        class="font-bold text-white mb-3 text-lg underline decoration-white/30 decoration-4 underline-offset-8"
                    >
                        Citaci√≥n
                    </h4>
                    <p class="text-xs text-white/90 leading-loose">
                        Estrategia de co-citaci√≥n. Conseguimos que otras fuentes
                        de autoridad te mencionen para validar tu estatus de
                        experto.
                    </p>
                </div>
            </div>
        </div>
    </section>

    {/* FOOTER: Perfil Experto */}
    {/* FOOTER: CTA Disruptivo */}
    <footer class="relative py-32 bg-black overflow-hidden">
        <div
            class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-gold/5 blur-[100px] rounded-full pointer-events-none"
        >
        </div>

        <div class="relative z-10 max-w-5xl mx-auto px-6">
            <div
                class="bg-neutral-900/30 backdrop-blur-xl border border-white/5 p-12 md:p-20 rounded-[3rem] text-center shadow-2xl relative overflow-hidden group hover:border-gold/20 transition-all duration-700"
            >
                <div
                    class="absolute inset-0 bg-gradient-to-b from-transparent via-gold/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-700 pointer-events-none"
                >
                </div>

                <div class="relative z-10">
                    <span
                        class="inline-block px-5 py-2 rounded-full bg-gold text-black font-black text-xs tracking-widest uppercase mb-10 shadow-[0_0_20px_-5px_rgba(212,175,55,0.5)]"
                    >
                        ¬øListo para 2026?
                    </span>

                    <h2
                        class="text-5xl md:text-7xl font-black text-white mb-8 tracking-tighter leading-none"
                    >
                        GEO es el <br />
                        <span
                            class="text-transparent bg-clip-text bg-gradient-to-r from-gold via-yellow-200 to-gold"
                            >Nuevo Est√°ndar</span
                        >
                    </h2>

                    <p
                        class="text-xl md:text-2xl text-neutral-400 max-w-3xl mx-auto mb-14 font-light leading-relaxed"
                    >
                        "No construyo p√°ginas web, construyo activos digitales
                        estrat√©gicos para la era de la IA."
                    </p>

                    <div
                        class="flex flex-col md:flex-row items-center justify-center gap-6"
                    >
                        <a
                            href="https://wa.me/573002984537?text=Hola%20Nicolas,%20quiero%20optimizar%20mi%20marca%20para%20la%20era%20GEO."
                            target="_blank"
                            class="group relative px-10 py-5 bg-white text-black font-black rounded-full text-lg hover:bg-gold transition-all duration-300 transform hover:scale-105 hover:shadow-[0_0_50px_-10px_rgba(212,175,55,0.6)] flex items-center gap-3"
                        >
                            <span>Solicitar Auditor√≠a GEO</span>
                            <span
                                class="group-hover:translate-x-1 transition-transform"
                                >‚Üí</span
                            >
                        </a>
                        <a
                            href="/contacto"
                            class="px-8 py-4 text-neutral-400 font-medium hover:text-white transition-colors flex items-center gap-2"
                        >
                            <span>Cotizar Proyecto</span>
                            <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="14"
                                height="14"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                ><path d="M5 12h14"></path><path
                                    d="M12 5l7 7-7 7"></path></svg
                            >
                        </a>
                    </div>

                    <div
                        class="mt-20 pt-10 border-t border-white/5 flex flex-col md:flex-row justify-between items-center gap-6 text-xs text-neutral-600 uppercase tracking-widest"
                    >
                        <div
                            class="font-bold text-neutral-400 flex items-center gap-2"
                        >
                            <div
                                class="w-2 h-2 bg-gold rounded-full animate-pulse"
                            >
                            </div>
                            Nicol√°s C√°rdenas
                        </div>
                        <div class="flex gap-8">
                            <span>Medell√≠n, CO</span>
                            <span>@cardenasnicolas</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</div>
